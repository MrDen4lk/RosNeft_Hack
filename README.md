# üó∫Ô∏è RosNeft Hack: Semantic Segmentation of Schematics

![PyTorch](https://img.shields.io/badge/PyTorch-2.0-ee4c2c)
![ONNX](https://img.shields.io/badge/ONNX-Runtime-blue)
![License](https://img.shields.io/badge/License-MIT-green)
![Metric](https://img.shields.io/badge/IoU-0.96-brightgreen)

–†–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–π —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ —É—Å–ª–æ–≤–Ω—ã—Ö –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏–π –Ω–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Å—Ö–µ–º–∞—Ö (40 –∫–ª–∞—Å—Å–æ–≤). –ü—Ä–æ–µ–∫—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –≤ —Ä–∞–º–∫–∞—Ö —Ö–∞–∫–∞—Ç–æ–Ω–∞ RosNeft Hack.

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –±—ã–ª–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–≥–æ –∑—Ä–µ–Ω–∏—è –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∏ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ —á–µ—Ä—Ç–µ–∂–∞—Ö –∏ —Å—Ö–µ–º–∞—Ö.
* **–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:** –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ö–µ–º —Å —É—Å–ª–æ–≤–Ω—ã–º–∏ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è–º–∏.
* **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Å–æ–≤:** 40 (+1 —Ñ–æ–Ω).
* **–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ:** 600x600 px.
* **–†–∞–∑–º–µ—Ä –¥–∞—Ç–∞—Å–µ—Ç–∞:** 10,000 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

## üõ†Ô∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –ü–æ–¥—Ö–æ–¥

### –í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏: U-Net++ + EfficientNet-B0 + Self-Attention
–ü–æ—Å–ª–µ —Å–µ—Ä–∏–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ –±—ã–ª–∞ –≤—ã–±—Ä–∞–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ **U-Net++**.

* **Encoder (Backbone):** `EfficientNet-B0` (Pre-trained on ImageNet). –ë—ã–ª –≤—ã–±—Ä–∞–Ω –∑–∞ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Å–∫–æ—Ä–æ—Å—Ç—å—é –æ–±—É—á–µ–Ω–∏—è –∏ –∫–∞—á–µ—Å—Ç–≤–æ–º –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.
* **Decoder:** U-Net++ —Å –º–µ—Ö–∞–Ω–∏–∑–º–æ–º **Nested Skip Pathways**, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –¥–µ—Ç–∞–ª–∏ –º–µ–ª–∫–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤ (–ª–∏–Ω–∏–π, —Å–∏–º–≤–æ–ª–æ–≤), —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã—Ö –¥–ª—è —á–µ—Ä—Ç–µ–∂–µ–π.
* **Attention:** –í "–±—É—Ç—ã–ª–æ—á–Ω–æ–µ –≥–æ—Ä–ª—ã—à–∫–æ" (bottleneck) –º–æ–¥–µ–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω –±–ª–æ–∫ **Self-Attention**. –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏–ª–æ –º–æ–¥–µ–ª–∏ —É—á–∏—Ç—ã–≤–∞—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å—Ö–µ–º—ã, —Å–≤—è–∑—ã–≤–∞—è —Ä–∞–∑—Ä–æ–∑–Ω–µ–Ω–Ω—ã–µ —á–∞—Å—Ç–∏ —É—Å–ª–æ–≤–Ω—ã—Ö –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏–π.

### –ü–æ—á–µ–º—É –Ω–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä—ã?
–ë—ã–ª–∞ –ø—Ä–µ–¥–ø—Ä–∏–Ω—è—Ç–∞ –ø–æ–ø—ã—Ç–∫–∞ –æ–±—É—á–µ–Ω–∏—è **SegFormer**. –û–¥–Ω–∞–∫–æ, –∏–∑-–∑–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö (—Å—Ö–µ–º–∞—Ç–∏—á–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–µ–∫—Å—Ç—É—Ä –∫–∞–∫ –Ω–∞ —Ñ–æ—Ç–æ) –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞ (10–∫), —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä –ø–æ–∫–∞–∑–∞–ª —Ö—É–¥—à—É—é —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å –∏ —Ç–æ—á–Ω–æ—Å—Ç—å –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å CNN –ø–æ–¥—Ö–æ–¥–æ–º.

### –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å –∏ –ú–µ—Ç—Ä–∏–∫–∏
* **Loss Function:** `DiceCELoss` (Dice Loss + Cross Entropy). –≠—Ç–∞ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –ø–æ–∑–≤–æ–ª–∏–ª–∞ —Ä–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É –¥–∏—Å–±–∞–ª–∞–Ω—Å–∞ –∫–ª–∞—Å—Å–æ–≤ (–º–µ–ª–∫–∏–µ –æ–±—ä–µ–∫—Ç—ã –ø—Ä–æ—Ç–∏–≤ –±–æ–ª—å—à–æ–≥–æ —Ñ–æ–Ω–∞) –∏ –æ–±–µ—Å–ø–µ—á–∏—Ç—å —á–µ—Ç–∫–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏.
* **Target Metric:** `IoU` (Intersection over Union), —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–π –±–µ–∑ —É—á–µ—Ç–∞ —Ñ–æ–Ω–æ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞ (Index 0).

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ú–æ–¥–µ–ª—å –ø–æ–∫–∞–∑–∞–ª–∞ –≤—ã—Å–æ–∫—É—é —Ç–æ—á–Ω–æ—Å—Ç—å –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ.

| Metric | Score |
| :--- | :--- |
| **mIoU (no background)** | **0.96** |
| Resolution | 600x600 |
| Classes | 40 |

## üíª –ò–Ω—Ñ–µ—Ä–µ–Ω—Å –∏ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

–î–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –º–æ–¥–µ–ª—å –±—ã–ª–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞ –≤ —Ñ–æ—Ä–º–∞—Ç **ONNX**. –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏–ª–æ –∑–∞–ø—É—Å–∫–∞—Ç—å —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—é –±–µ–∑ —Ç—è–∂–µ–ª—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π PyTorch –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ.
